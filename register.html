<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>注册页面</title>
	<link rel="stylesheet" href="css/iconfont.css">
	<link rel="stylesheet" href="css/registerSass.css">
</head>
<body>
	<div class="box">
		<p class="p1">官网会员权益，购正装获积分，畅想明星兑礼。</p>
		<div class="content" id="tog1">
			<div class="bottom" >
				<div class="reg reg1">
				  	<i>手机号*</i><input type="text" placeholder="手机号"  class="clearA phone" id="phonenum"  >
					<span>请输入有效的手机号</span>
					<span class="secSpan">请输入有效的手机号码</span>
					<span></span>
				  </div>
				  <div class="reg reg2">
				  	<i> 验证码*</i><input type="text" placeholder="输入验证码" class="shuyzm">
				  	<i class="yzm" id="firy">4462</i> <span class="huan">看不清？<br><a>换一张</a></span>
				  </div>
				  <div class="reg reg1">
				  	<i>密码*</i>
					<input type="text" placeholder="请填写密码，至少8个字符" class="clearA" id="userpass"> 
					<span>请输入您的密码</span>
					<span class="secSpan">密码不正确</span>
					<span class="secSpan">最小长度8位，包含大小写字母和数字（或符号）</span>
				  </div>
				  <div class="reg reg2">
				  	<i>短信验证码*</i><input type="text" placeholder="短信验证码" class="infor clearA" id="information">
					<span>请输入短信验证码</span>
					<span class="secSpan" >请输入正确的验证码</span>
					<input type="button value
				  	立即注册" class="send" value="发送">
				  </div>
				  <div class="reg reg1" >
				  	<i>确认密码*</i><input type="text" placeholder="请再次输入您的密码" class="clearA" >
				  	<span>请输入确认密码</span>
					
					<span class="secSpan">两次密码不一致</span>
				  </div><br>
				  <div class=" reg baocun">
					    <em id="eem"><span class="iconfont icon-duihao2"></span></em>
						<b>我同意依照本使用条款和隐私政策对我的个人信息进行收集和使用；
						我已阅读并确认被给予充分机会理解该使用条款和隐私政策的内容。</b>
				  </div>
				 <div  class="reg reg3">
				     <input type="button" value="立即注册" class="regBtn" id="regBtnp">
				 </div>
				<div id="messageBox">
				</div>
			</div>
				 <p class="regg regem">邮箱注册></p>
			</div>
		
		<div class="content" id="tog2" >
				<div class="bottom">
							<div class="reg reg1">
								<i>邮箱*</i><input type="text" placeholder="邮箱" class="clearA"  id="useremail">
								<span>请输入有效邮箱</span>
								<span class="secSpan">请输入有效的邮箱</span>
								<span></span>
							 </div>
							 <div class="reg reg2">
							 	<i>手机号*</i><input type="text" placeholder="手机号" class="clearA">
								<span>请输入有效手机号</span>
								
								<span class="secSpan">请输入有效的手机号码</span>
							  </div>
							  <div class="reg reg1">
							  	  <i>密码*</i><input type="text" placeholder="请填写密码，至少8个字符" class="clearA"> 
								  <span>请输入您的密码</span>
								  <span class="secSpan">密码不正确</span>
								  <span class="secSpan">最小长度8位，包含大小写字母和数字（或符号）</span>
							  </div>
							 <div class="reg reg2">
								<i> 验证码*</i><input type="text" placeholder="输入验证码" class="shuyzm">
								<i class="yzm" id="secf">4462</i><span class="huan">看不清？<br><a >换一张</a></span>
							 </div>
							 <div class="reg reg1" >
							 	<i>确认密码*</i><input type="text" placeholder="请再次输入您的密码" class="clearA">
							 	<span>请输入确认密码</span>
								
								<span class="secSpan" style="display:none;">两次密码不一致</span>
							 															
							 </div>
							 <div class="reg reg2">
								<i>短信验证码*</i>
								<input type="text" placeholder="短信验证码" class="infor clearA">
								<span>请输入短信验证码</span>
					             <span class="secSpan" style="display:none;" >请输入正确的验证码</span>
								
								<input type="button" class="send send1" value="发送">
							 </div>
							
							 <div class=" reg baocun">
								<em id="eem2"><span class="iconfont icon-duihao2"></span></em>
								<b>我同意依照本使用条款和隐私政策对我的个人信息进行收集和使用；
								我已阅读并确认被给予充分机会理解该使用条款和隐私政策的内容。</b>
							 </div>
							<div  class="reg reg3">
							   <input type="button" value="立即注册"  class="regBtn" id="regBtne">
							</div>
							<div id="messageBox">
							</div>							
						</div>	  
				<p class="regg regnum">手机号注册></p>			  
		</div>
				
				
		
		  
		
	</div>
</body>
</html>
<script src="js/jquery-1.8.3.min.js"></script>
<script src="js/random.js"></script>
<script src="js/cookieTools.js"></script>
<script>
	// 邮箱和手机号注册切换
	let count=1;
$("#eem").click(function(){
	count++;
	
	if(count%2==0){
		$("#eem").children(0).css("display","block");
	}else{
		$("#eem").children(0).css("display","none");
	}
});
	let count1=1;
$("#eem2").click(function(){
	count1++;
	
	if(count1%2==0){
		$("#eem2").children(0).css("display","block");
	}else{
		$("#eem2").children(0).css("display","none");
	}
});

$(".regem").click(function(){
	 $('#tog2').show();
	 $('#tog1').hide();
	
}) 
$(".regnum").click(function(){
	 $('#tog2').hide();
	 $('#tog1').show();
	
})  
// 随机验证码
my$(".huan")[0].onclick=function(){
	let num=getMa();
	my$("#firy").innerHTML=num;
	
}
my$(".huan")[1].onclick=function(){
	let num=getMa();
	my$("#secf").innerHTML=num;
	
}
 
 // 判断输入框是否输入东西
  let inputs=my$(".clearA");
  let secSpan=$(".secSpan")
  let placeVal;
 for(let j=0;j<inputs.length;j++){
	 inputs[j].nextElementSibling.style.display="none";
	 secSpan.eq(j).css("display","none");
	  
	 
	 
	 inputs[j].onfocus=function(){
		placeVal=$(this).attr("placeholder");
	    $(this).attr("placeholder","");
} 
	 let count=1;
	 inputs[j].onblur=function(){
		 count++;
		
		  $(this).attr("placeholder",placeVal);
		 if(count%2==0){
			inputs[j].nextElementSibling.style.display="block";
			secSpan.eq(j).css("display","none");
			
			inputs[j].nextElementSibling.style.color="#D51B51";
			inputs[j].nextElementSibling.style.fontSize="12px";
			inputs[j].nextElementSibling.style.textAlign="center";
			this.style.border="1px solid #D51B51";
			
		}
		if(count>0 & inputs[j]==inputs[0] || count>0 & inputs[j]==inputs[5]){
			let str=this.value;
			let reg=/^1\d{10}$/;
			if(j==5){
				if(reg.test(str)==true){
					inputs[j].nextElementSibling.style.display="none"; 
					secSpan.eq(j+1).css("display","none");
					this.style.border="1px solid #999999";
				}else if(str==""){
					inputs[j].nextElementSibling.style.display="block";
					secSpan.eq(j+1).css("display","none"); 
				}else{
					inputs[j].nextElementSibling.style.display="none";
					
					secSpan.eq(j+1).css({display:"block",color:"#D51B51",textAlign:"center",fontSize:"12px"}); 
				}
					
			}else{
				if(reg.test(str)==true){
					inputs[j].nextElementSibling.style.display="none"; 
					secSpan.eq(j).css("display","none");
					this.style.border="1px solid #999999";
				}else if(str==""){
					inputs[j].nextElementSibling.style.display="block";
					secSpan.eq(j).css("display","none"); 
				}else{
					inputs[j].nextElementSibling.style.display="none";
					
					secSpan.eq(j).css({display:"block",color:"#D51B51",textAlign:"center",fontSize:"12px"}); 
				}
					
			}
			
			// 确认密码
		}else if(count>0 & inputs[j]==inputs[1] || count>0 & inputs[j]==inputs[6]){
			let pass=this.value;
			inputs[j].nextElementSibling.style.display="none";
			secSpan.eq(j+1).css("display","none"); 
			secSpan.eq(j+2).css("display","none"); 
		    if(j==6){
			if(pass==""){
				inputs[j].nextElementSibling.style.display="block";
				secSpan.eq(j+1).css("display","none"); 
				secSpan.eq(j+2).css("display","none"); 
				
				 
				
				}else if(pass.length<8){
				  inputs[j].nextElementSibling.style.display="none";
				  secSpan.eq(j+1).css({display:"none",color:"#D51B51",textAlign:"center",fontSize:"12px"});
				secSpan.eq(j+2).css({display:"block",color:"#D51B51",textAlign:"center",fontSize:"12px"}); 
				 return;
			 }
							
				 //2)、必须含有字母
				 var hasLetter = false;
				 for(var i=0;i<pass.length;i++){
				     var code = pass.charCodeAt(i);
					if(pass==""){
						inputs[j].nextElementSibling.style.display="block";
						secSpan.eq(j+1).css("display","none"); 
						secSpan.eq(j+2).css("display","none");
						
					}else if((code>=65 && code<=90) || (code>=97 && code<=122)){//有没有字母
					 hasLetter = true;
					 break;
				 }
}
				if(pass==""){
					inputs[j].nextElementSibling.style.display="block";
					secSpan.eq(j+1).css("display","none"); 
					secSpan.eq(j+2).css("display","none"); 
					
				}else if(hasLetter==false){//!hasLetter
				     inputs[j].nextElementSibling.style.display="none";
									
				     secSpan.eq(j+1).css({display:"none",color:"#D51B51",textAlign:"center",fontSize:"12px"}); 
					secSpan.eq(j+2).css({display:"block",color:"#D51B51",textAlign:"center",fontSize:"12px"}); 
				     return;
				 }
				 
				 //3)、必须含有数字
				 var hasNum = false;
				 for(var i=0;i<pass.length;i++){
				     var code = pass.charCodeAt(i);
					if(pass==""){
						inputs[j].nextElementSibling.style.display="block";
						secSpan.eq(j+1).css("display","none"); 
						secSpan.eq(j+2).css("display","none"); 
						
					}
				    else if(code>=48 && code<=57){
				         hasNum = true;
				         break;
				     }
		         }
						if(pass==""){
							inputs[j].nextElementSibling.style.display="block";
							secSpan.eq(j+1).css("display","none"); 
							secSpan.eq(j+2).css("display","none"); 
							
						}
				 else if(hasNum==false){//!hasNum
				    inputs[j].nextElementSibling.style.display="none";
				    	secSpan.eq(j+1).css({display:"none",color:"#D51B51",textAlign:"center",fontSize:"12px"}); 
						secSpan.eq(j+2).css({display:"block",color:"#D51B51",textAlign:"center",fontSize:"12px"}); 
				     return;
				 }
				 
				 //4)、必须含有特殊字符
				 var arr=["$","%","!","#","*","@"];
				 var hasSpec = false;
				 for(var i=0;i<pass.length;i++){
				     var char = pass.charAt(i);//$
						if(pass==""){
							inputs[j].nextElementSibling.style.display="block";
							secSpan.eq(j+1).css("display","none"); 
							secSpan.eq(j+2).css("display","none"); 
							
						}
				    else if(arr.indexOf(char)>-1){
				         hasSpec = true;
				         break;
				     }
				 }
				 if(pass==""){
				 	inputs[j].nextElementSibling.style.display="block";
				 	secSpan.eq(j+1).css("display","none"); 
				 	secSpan.eq(j+2).css("display","none"); 
				 	
				 }else if(hasSpec==false){//!hasSpec
				     inputs[j].nextElementSibling.style.display="none";
				     secSpan.eq(j+1).css({display:"none",color:"#D51B51",textAlign:"center",fontSize:"12px"}); 
					secSpan.eq(j+2).css({display:"block",color:"#D51B51",textAlign:"center",fontSize:"12px"}); 
					this.style.border="1px solid #999999";
								
				     return;
				 }
							
				//3、输出
				if(pass==""){
					inputs[j].nextElementSibling.style.display="block";
					secSpan.eq(j+1).css("display","none"); 
					secSpan.eq(j+2).css("display","none"); 
					
				}else{
				   inputs[j].nextElementSibling.style.display="none";
				   secSpan.eq(j+1).css("display","none");
				   secSpan.eq(j+2).css("display","none");
				   this.style.border="1px solid #999999";
				}
			}else{
				if(pass==""){
							inputs[j].nextElementSibling.style.display="block";
							secSpan.eq(j+1).css("display","none"); 
							secSpan.eq(j+2).css("display","none"); 
							
				}else if(pass.length<8){
				    inputs[j].nextElementSibling.style.display="none";
					secSpan.eq(j).css({display:"none",color:"#D51B51",textAlign:"center",fontSize:"12px"});
				    secSpan.eq(j+1).css({display:"block",color:"#D51B51",textAlign:"center",fontSize:"12px"}); 
				     return;
				 }
							
				 //2)、必须含有字母
				 var hasLetter = false;
				 for(var i=0;i<pass.length;i++){
				     var code = pass.charCodeAt(i);
						if(pass==""){
							inputs[j].nextElementSibling.style.display="block";
							secSpan.eq(j).css("display","none"); 
							secSpan.eq(j+1).css("display","none"); 
							
						}else if((code>=65 && code<=90) || (code>=97 && code<=122)){//有没有字母
				         hasLetter = true;
				         break;
				     }
				 }
					if(pass==""){
						inputs[j].nextElementSibling.style.display="block";
						secSpan.eq(j).css("display","none"); 
						secSpan.eq(j+1).css("display","none"); 
						
					}
				 else if(hasLetter==false){//!hasLetter
				     inputs[j].nextElementSibling.style.display="none";
									
				     secSpan.eq(j).css({display:"none",color:"#D51B51",textAlign:"center",fontSize:"12px"}); 
					secSpan.eq(j+1).css({display:"block",color:"#D51B51",textAlign:"center",fontSize:"12px"}); 
				     return;
				 }
				 
				 //3)、必须含有数字
				 var hasNum = false;
				 for(var i=0;i<pass.length;i++){
				     var code = pass.charCodeAt(i);
									if(pass==""){
										inputs[j].nextElementSibling.style.display="block";
										secSpan.eq(j).css("display","none"); 
										secSpan.eq(j+1).css("display","none"); 
										
									}
				    else if(code>=48 && code<=57){
				         hasNum = true;
				         break;
				     }
				 }
								if(pass==""){
									inputs[j].nextElementSibling.style.display="block";
									secSpan.eq(j).css("display","none"); 
									secSpan.eq(j+1).css("display","none"); 
									
								}
				 else if(hasNum==false){//!hasNum
				    inputs[j].nextElementSibling.style.display="none";
				    	secSpan.eq(j).css({display:"none",color:"#D51B51",textAlign:"center",fontSize:"12px"}); 
						secSpan.eq(j+1).css({display:"block",color:"#D51B51",textAlign:"center",fontSize:"12px"}); 
				     return;
				 }
				 
				 //4)、必须含有特殊字符
				 var arr=["$","%","!","#","*","@"];
				 var hasSpec = false;
				 for(var i=0;i<pass.length;i++){
				     var char = pass.charAt(i);//$
							if(pass==""){
								inputs[j].nextElementSibling.style.display="block";
								secSpan.eq(j).css("display","none"); 
								secSpan.eq(j+1).css("display","none"); 
								
							}
				    else if(arr.indexOf(char)>-1){
				         hasSpec = true;
				         break;
				     }
				 }
				 if(pass==""){
				 	inputs[j].nextElementSibling.style.display="block";
				 	secSpan.eq(j).css("display","none"); 
				 	secSpan.eq(j+1).css("display","none"); 
				 	
				 }else if(hasSpec==false){//!hasSpec
				     inputs[j].nextElementSibling.style.display="none";
				     secSpan.eq(j).css({display:"none",color:"#D51B51",textAlign:"center",fontSize:"12px"}); 
					secSpan.eq(j+1).css({display:"block",color:"#D51B51",textAlign:"center",fontSize:"12px"}); 
									this.style.border="1px solid #999999";
								
				     return;
				 }
							
				//3、输出
				if(pass==""){
					inputs[j].nextElementSibling.style.display="block";
					secSpan.eq(j).css("display","none"); 
					secSpan.eq(j+1).css("display","none"); 
					
				}else{
				   inputs[j].nextElementSibling.style.display="none";
				   secSpan.eq(j).css("display","none");
				   secSpan.eq(j+1).css("display","none");
				   this.style.border="1px solid #999999";
				}
			}
			  
			    
			// 短信验证码
			}else if(count>0 & inputs[j]==inputs[2] || count>0 & inputs[j]==inputs[8]){
				let str=this.value;
				let reg=/^\d{6}$/;
				inputs[j].nextElementSibling.style.display="none";
				secSpan.eq(j+2).css("display","none");
				if(j==8){
						if(str==''){
							inputs[j].nextElementSibling.style.display="block"; 
							// secSpan.eq(j+2).css({display:"none",}); 
							secSpan.eq(j+2).css("display","none"); 
							
						}
						else if(reg.test(str)==true){
							inputs[j].nextElementSibling.style.display="none"; 
							secSpan.eq(j+2).css("display","none");	
							this.style.border="1px solid #999999";
						}else{
							inputs[j].nextElementSibling.style.display="none";
							secSpan.eq(j+2).css({display:"block",color:"#D51B51",textAlign:"center",fontSize:"12px"}); 
								}	
					}else{
							if(str==''){
								inputs[j].nextElementSibling.style.display="block"; 
								secSpan.eq(j+1).css({display:"none",}); 
							}
							else if(reg.test(str)==true){
								inputs[j].nextElementSibling.style.display="none"; 
								secSpan.eq(j+1).css("display","none");	
								this.style.border="1px solid #999999";
							}else{
								inputs[j].nextElementSibling.style.display="none";
								secSpan.eq(j+1).css({display:"block",color:"#D51B51",textAlign:"center",fontSize:"12px"}); 
							}
					}
				// 确认密码
			}else if(count>0 & inputs[j]==inputs[3]|| count>0 & inputs[j]==inputs[7] ){
				let str=inputs[1].value;
				let str2=inputs[6].value;
				inputs[j].nextElementSibling.style.display="none";
				secSpan.eq(j+2).css("display","none"); 
				if(j==7){
					if(inputs[j].value==''){
						inputs[j].nextElementSibling.style.display="block"; 
						secSpan.eq(j+2).css("display","none"); 
						// secSpan.eq(j+2).css("display","none"); 
					}
					else if(inputs[j].value==str2){
						inputs[j].nextElementSibling.style.display="none"; 
						secSpan.eq(j+2).css("display","none");
						// secSpan.eq(j+2).css("display","none");
						this.style.border="1px solid #999999";
					}else if(inputs[j].value!=str2){
						// secSpan.eq(j+2).css("display","none"); 
						inputs[j].nextElementSibling.style.display="none"; 
						secSpan.eq(j+2).css({display:"block",color:"#D51B51",textAlign:"center",fontSize:"12px"});
					}
				}else{
					if(inputs[j].value==''){
						inputs[j].nextElementSibling.style.display="block"; 
						secSpan.eq(j+1).css("display","none"); 
						// secSpan.eq(j+2).css("display","none"); 
					}
					else if(inputs[j].value==str){
						inputs[j].nextElementSibling.style.display="none"; 
						secSpan.eq(j+1).css("display","none");
						// secSpan.eq(j+2).css("display","none");
						this.style.border="1px solid #999999";
					}else if(inputs[j].value!=str){
						secSpan.eq(j+1).css("display","none"); 
						inputs[j+1].nextElementSibling.style.display="block"; 
						// secSpan.eq(j+2).css({display:"block",color:"#D51B51",textAlign:"center",fontSize:"12px"});
					}
				}
				 
				
			}else if(count>0 & inputs[j]==inputs[4]){
				
					let str=this.value;
					let  reg = /^\w{3,16}@\w{2,16}\.(com|net|com.cn|cn)$/;
					
					if(reg.test(str)==true){
						inputs[j].nextElementSibling.style.display="none"; 
						secSpan.eq(j+1).css("display","none");
						this.style.border="1px solid #999999";
					}else if(str==""){
						inputs[j].nextElementSibling.style.display="block";
						secSpan.eq(j+1).css("display","none"); 
					}else{
						inputs[j].nextElementSibling.style.display="none";
						
						secSpan.eq(j+1).css("display","block"); 
					}
	            }
			
			
			
		}
	}
  
// 验证用户名在数据库中是否存在
my$("#regBtnp").onclick = function(){
    //1、
    let xhr = new XMLHttpRequest();

    xhr.open("post","regSave.php",true);

    xhr.onreadystatechange = function(){
        if(xhr.readyState==4 && xhr.status==200){
            if(xhr.responseText=="-1"){
                my$("#messageBox").style.color ="red";
                my$("#messageBox").innerHTML ="该号码被人使用";
            }else if(xhr.responseText=="0"){
                my$("#messageBox").style.color ="red";
                my$("#messageBox").innerHTML ="注册失败";
            }else if(xhr.responseText=="1"){
				 addCookie("phonenum",my$("#phonenum").value,7);
				 location.href="index.html";
				 regSuccess();
               
            }
        }
    }
    //post方式：设置请求头
    xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
    //post方式：把传给服务器端数据（键值对）放在send函数的参数里。
    let sendstr = `phonenum=${my$("#phonenum").value}&userpass=${my$("#userpass").value}`;
    xhr.send(sendstr);

}


 function my$(str){
 	if(str.charAt(0)=="#"){
 		return document.getElementById(str.substring(1));
 	}else if(str.charAt(0)=="."){
 		return document.getElementsByClassName(str.substring(1));
 	}else{
 		return document.getElementsByTagName(str);
 	}
 }	
     
    

</script>
